<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>URL Pinger</title>
    <script src="https://cdn.tailwindcss.com"></script>
  </head>
  <body class="min-h-screen bg-slate-950 text-white">
    <main class="mx-auto flex max-w-3xl flex-col gap-8 px-4 py-12">
      <header class="space-y-3 text-center">
        <p class="text-sm uppercase tracking-[0.4em] text-slate-400">
          URL Pinger
        </p>
        <h1 class="text-3xl font-semibold tracking-tight text-white">
          Check site response time in seconds
        </h1>
        <div
          class="inline-flex items-center gap-2 rounded-full border border-slate-800 bg-slate-900 px-3 py-1 text-xs text-slate-300"
        >
          <span class="size-2 rounded-full bg-emerald-400"></span>
          Realtime monitoring ready
        </div>
      </header>

      <nav class="grid grid-cols-1 gap-3 sm:grid-cols-2">
        <button
          id="single-tab"
          class="rounded-2xl border border-slate-800 bg-white/5 px-5 py-4 text-left text-white backdrop-blur transition hover:border-white/40"
        >
          <div class="text-sm uppercase tracking-[0.4em] text-slate-400">
            Page 01
          </div>
          <h2 class="text-xl font-semibold">Single URL speed check</h2>
          <p class="text-sm text-slate-300">
            Paste a link and ping it instantly.
          </p>
        </button>
        <button
          id="multi-tab"
          class="rounded-2xl border border-slate-800 bg-white/5 px-5 py-4 text-left text-slate-300 backdrop-blur transition hover:border-white/40"
        >
          <div class="text-sm uppercase tracking-[0.4em] text-slate-600">
            Page 02
          </div>
          <h2 class="text-xl font-semibold text-white">
            Multi URL batch check
          </h2>
          <p class="text-sm text-slate-300">
            Load-test several domains at once.
          </p>
        </button>
      </nav>

      <section
        id="single-panel"
        class="space-y-4 rounded-3xl border border-white/10 bg-gradient-to-br from-white/10 via-white/5 to-transparent p-6 shadow-2xl shadow-emerald-500/20"
      >
        <div class="flex items-center justify-between">
          <h3 class="text-lg font-semibold text-white">Single Site Ping</h3>
          <span
            class="rounded-full bg-emerald-400/20 px-3 py-1 text-xs font-medium text-emerald-300"
          >
            Fast check
          </span>
        </div>
        <form id="single-form" class="space-y-3">
          <label class="text-sm text-slate-300" for="single-url">
            Enter a URL
          </label>
          <div class="flex flex-col gap-3 sm:flex-row">
            <input
              id="single-url"
              name="single-url"
              type="url"
              placeholder="https://example.com"
              class="w-full rounded-2xl border border-white/20 bg-white/5 px-4 py-3 text-white placeholder:text-slate-400 focus:border-emerald-400 focus:outline-none"
            />
            <button
              type="submit"
              class="rounded-2xl bg-emerald-500 px-6 py-3 text-sm font-semibold text-slate-950 transition hover:bg-emerald-400"
            >
              Ping
            </button>
          </div>
        </form>

        <!-- Results Table -->
        <div id="results-container" class="hidden mt-6">
          <div class="rounded-2xl border border-white/20 bg-white/5 p-6">
            <h4 class="text-sm font-semibold text-white mb-4">Results</h4>
            <div class="overflow-x-auto">
              <table class="w-full text-sm">
                <tbody id="results-table">
                  <!-- Results will be inserted here -->
                </tbody>
              </table>
            </div>
          </div>
        </div>
      </section>

      <section
        id="multi-panel"
        class="hidden space-y-4 rounded-3xl border border-white/10 bg-gradient-to-br from-cyan-500/10 via-white/5 to-transparent p-6 shadow-2xl shadow-cyan-500/20"
      >
        <div class="flex items-center justify-between">
          <h3 class="text-lg font-semibold text-white">Multi Site Ping</h3>
          <span
            class="rounded-full bg-cyan-400/20 px-3 py-1 text-xs font-medium text-cyan-200"
          >
            Batch mode
          </span>
        </div>
        <form id="multi-form" class="space-y-3">
          <label class="text-sm text-slate-300" for="multi-url">
            Add one URL per line (max 10)
          </label>
          <textarea
            id="multi-url"
            rows="6"
            placeholder="https://one.com&#10;https://two.com"
            class="w-full rounded-2xl border border-white/20 bg-white/5 px-4 py-3 text-white placeholder:text-slate-400 focus:border-cyan-400 focus:outline-none"
          ></textarea>
          <div class="flex flex-col gap-3 sm:flex-row">
            <button
              id="multi-clear"
              type="button"
              class="rounded-2xl border border-white/20 px-6 py-3 text-sm font-semibold text-white transition hover:border-white/40"
            >
              Clear
            </button>
            <button
              type="submit"
              class="rounded-2xl bg-cyan-400 px-6 py-3 text-sm font-semibold text-slate-900 transition hover:bg-cyan-300"
            >
              Ping All
            </button>
          </div>
        </form>

        <!-- Multi Results Table -->
        <div id="multi-results-container" class="hidden mt-6">
          <div class="rounded-2xl border border-white/20 bg-white/5 p-6">
            <h4 class="text-sm font-semibold text-white mb-4">Batch Results</h4>
            <div class="overflow-x-auto">
              <table class="w-full text-xs sm:text-sm">
                <thead>
                  <tr class="border-b border-white/10 text-slate-400">
                    <th class="py-2 pr-4 text-left font-medium">URL</th>
                    <th class="py-2 pr-4 text-left font-medium">Load (s)</th>
                    <th class="py-2 pr-4 text-left font-medium">TTFB (ms)</th>
                    <th class="py-2 pr-4 text-left font-medium">DNS (ms)</th>
                    <th class="py-2 pr-4 text-left font-medium">TLS (ms)</th>
                    <th class="py-2 pr-4 text-left font-medium">Status</th>
                  </tr>
                </thead>
                <tbody id="multi-results-table">
                  <!-- Batch results will be inserted here -->
                </tbody>
              </table>
            </div>
          </div>
        </div>
      </section>
    </main>

    <script>
      const singleTab = document.getElementById("single-tab");
      const multiTab = document.getElementById("multi-tab");
      const singlePanel = document.getElementById("single-panel");
      const multiPanel = document.getElementById("multi-panel");
      const singleForm = document.getElementById("single-form");
      const singleUrlInput = document.getElementById("single-url");
      const multiForm = document.getElementById("multi-form");
      const multiUrlInput = document.getElementById("multi-url");
      const multiClearBtn = document.getElementById("multi-clear");

      const activate = (isSingle) => {
        singlePanel.classList.toggle("hidden", !isSingle);
        multiPanel.classList.toggle("hidden", isSingle);

        singleTab.classList.toggle("text-white", isSingle);
        singleTab.classList.toggle("text-slate-300", !isSingle);
        singleTab.classList.toggle("border-white/30", isSingle);

        multiTab.classList.toggle("text-white", !isSingle);
        multiTab.classList.toggle("text-slate-300", isSingle);
        multiTab.classList.toggle("border-white/30", !isSingle);
      };

      singleTab.addEventListener("click", () => activate(true));
      multiTab.addEventListener("click", () => activate(false));

      const resultsContainer = document.getElementById("results-container");
      const resultsTable = document.getElementById("results-table");
      const multiResultsContainer = document.getElementById(
        "multi-results-container"
      );
      const multiResultsTable = document.getElementById("multi-results-table");

      singleForm.addEventListener("submit", async (event) => {
        event.preventDefault();
        const url = singleUrlInput.value.trim();
        if (!url) return;

        // Show loading state
        resultsContainer.classList.remove("hidden");
        resultsTable.innerHTML =
          '<tr><td class="text-slate-400">Loading...</td></tr>';

        try {
          const response = await fetch("/submit-single-url", {
            method: "POST",
            headers: {
              "Content-Type": "application/x-www-form-urlencoded",
            },
            body: new URLSearchParams({ "single-url": url }),
          });

          if (!response.ok) {
            throw new Error(`HTTP error! status: ${response.status}`);
          }

          const data = await response.json();

          // Update table with results
          resultsTable.innerHTML = `
            <tr class="border-b border-white/10">
              <td class="py-3 pr-4 text-slate-400 font-medium w-1/3">URL</td>
              <td class="py-3 text-white break-all">${data.url}</td>
            </tr>
            <tr class="border-b border-white/10">
              <td class="py-3 pr-4 text-slate-400 font-medium">Load Event</td>
              <td class="py-3 text-white">${data.loadEvent.toFixed(
                2
              )} seconds</td>
            </tr>
            <tr class="border-b border-white/10">
              <td class="py-3 pr-4 text-slate-400 font-medium">TTFB</td>
              <td class="py-3 text-white">${data.ttfb.toFixed(2)} ms</td>
            </tr>
            <tr class="border-b border-white/10">
              <td class="py-3 pr-4 text-slate-400 font-medium">DNS</td>
              <td class="py-3 text-white">${data.dns.toFixed(2)} ms</td>
            </tr>
            <tr class="border-b border-white/10">
              <td class="py-3 pr-4 text-slate-400 font-medium">TLS</td>
              <td class="py-3 text-white">${data.tls.toFixed(2)} ms</td>
            </tr>
            ${
              data.slowImages && data.slowImages.length > 0
                ? `
            <tr>
              <td class="py-3 pr-4 text-slate-400 font-medium align-top">Slow Images</td>
              <td class="py-3 text-white">
                <ul class="list-disc list-inside space-y-1 text-xs">
                  ${data.slowImages
                    .map((img) => `<li class="break-all">${img}</li>`)
                    .join("")}
                </ul>
              </td>
            </tr>
            `
                : ""
            }
          `;
        } catch (err) {
          resultsTable.innerHTML = `<tr><td class="text-red-400">Error: ${err.message}</td></tr>`;
          console.error("Ping failed:", err);
        }
      });

      // Multi-site submit
      multiForm.addEventListener("submit", async (event) => {
        event.preventDefault();
        const raw = multiUrlInput.value;
        const urls = raw
          .split("\n")
          .map((u) => u.trim())
          .filter((u) => u.length > 0)
          .slice(0, 10);

        if (urls.length === 0) return;

        multiResultsContainer.classList.remove("hidden");
        multiResultsTable.innerHTML =
          '<tr><td colspan="6" class="py-2 text-slate-400">Loading...</td></tr>';

        try {
          const response = await fetch("/submit-multi-url", {
            method: "POST",
            headers: {
              "Content-Type": "application/x-www-form-urlencoded",
            },
            body: new URLSearchParams({ "multi-url": urls.join("\n") }),
          });

          if (!response.ok) {
            throw new Error(`HTTP error! status: ${response.status}`);
          }

          const data = await response.json();

          if (!Array.isArray(data)) {
            throw new Error("Unexpected response format");
          }

          multiResultsTable.innerHTML = data
            .map((item) => {
              const hasError = !!item.error;
              return `
              <tr class="border-b border-white/10">
                <td class="py-2 pr-4 text-white break-all">${item.url}</td>
                <td class="py-2 pr-4 text-slate-200">
                  ${
                    hasError || item.loadEvent == null
                      ? "-"
                      : item.loadEvent.toFixed(2)
                  }
                </td>
                <td class="py-2 pr-4 text-slate-200">
                  ${hasError || item.ttfb == null ? "-" : item.ttfb.toFixed(2)}
                </td>
                <td class="py-2 pr-4 text-slate-200">
                  ${hasError || item.dns == null ? "-" : item.dns.toFixed(2)}
                </td>
                <td class="py-2 pr-4 text-slate-200">
                  ${hasError || item.tls == null ? "-" : item.tls.toFixed(2)}
                </td>
                <td class="py-2 pr-4 ${
                  hasError ? "text-amber-300" : "text-emerald-300"
                }">
                  ${hasError ? `Error` : "OK"}
                </td>
              </tr>
              ${
                !hasError
                  ? `
              <tr class="border-b border-white/5 bg-slate-900/40">
                <td colspan="6" class="py-2 pl-4">
                  <details class="group cursor-pointer">
                    <summary class="text-xs text-slate-300 outline-none select-none">
                      Slow assets for <span class="text-white">${
                        item.url
                      }</span>${
                      item.slowImages && item.slowImages.length
                        ? ` \u2013 ${item.slowImages.length} items`
                        : ""
                    }
                    </summary>
                    ${
                      item.slowImages && item.slowImages.length
                        ? `
                    <ul class="mt-2 list-disc list-inside space-y-1 text-[11px] sm:text-xs text-slate-200">
                      ${item.slowImages
                        .map(
                          (img) =>
                            `<li class="break-all leading-snug">${img}</li>`
                        )
                        .join("")}
                    </ul>
                    `
                        : `<p class="mt-2 text-[11px] text-slate-400">No slow assets detected</p>`
                    }
                  </details>
                </td>
              </tr>
              `
                  : ""
              }
            `;
            })
            .join("");
        } catch (err) {
          multiResultsTable.innerHTML = `<tr><td colspan="6" class="py-2 text-red-400">Error: ${err.message}</td></tr>`;
          console.error("Multi ping failed:", err);
        }
      });

      // Multi clear button
      multiClearBtn.addEventListener("click", () => {
        multiUrlInput.value = "";
        multiResultsContainer.classList.add("hidden");
        multiResultsTable.innerHTML = "";
      });
    </script>



<h1>Hello World docker working </h1>
<p>This is a test</p>
<p>This is a test</p>
  </body>
</html>
